<div {{ attributes }}>
{% include 'game_session/partials/_timeline.html.twig' %}
    {{ form_start(form) }}
        {{ form_row(form.query, {
            attr: {
                class: 'input',
                'data-live-action-param': 'debounce(500)|search',
                'data-action': 'live#action',
                'data-model': 'query'
            },
            label_attr: {'class': 'block text-sm font-medium text-neonBlue mb-2'}
        }) }}
    {{ form_end(form) }}

    {% if errorMessage %}
        <p class="mt-3 text-red-400 bg-red-950/40 border border-red-800 rounded p-2">
            {{ errorMessage }}
        </p>
    {% endif %}    

    {% if rawgData is not empty %}
    <div class="mt-6 flex justify-center items-center gap-2">
            {% for p in 1..maxPageLoaded %}
                <button
                    type="button"
                    class="px-3 py-1 rounded-lg border {{ p == page ? 'bg-neonBlue text-black' : 'bg-gray-800 text-gray-300 hover:bg-gray-700 cursor-pointer' }}"
                    data-action="live#action"
                    data-live-action-param="goToPage"
                    data-live-page-param="{{ p }}">
                    {{ p }}
                </button>
            {% endfor %}

            <button
                type="button"
                class="px-3 py-1 rounded-lg bg-gray-800 text-gray-300 hover:bg-gray-700 cursor-pointer"
                data-action="live#action"
                data-live-action-param="nextPage">
                Suivant →
            </button>
        </div>
        <div class="mt-4 flex flex-wrap justify-center">
            {% for g in rawgData %}
                <div class="bg-gray-900 border border-neonBlue hover:border-2 hover:transform hover:scale-105 transition-transform duration-200 overflow-hidden flex flex-col w-full sm:w-1/2 md:w-1/3 lg:w-1/4">
                    {% if g.background_image %}
                        <img src="{{ g.background_image }}" alt="{{ g.name }}" class="w-full h-48 object-cover">
                    {% endif %}
                    <div class="p-4 flex flex-col flex-grow">
                        <p class="font-semibold text-neonBlue text-lg mb-1">{{ g.name }}</p>
                        <p class="text-gray-400 text-sm mb-1">Date : {{ g.released ?? 'N/A' }}</p>
                        <p class="text-gray-400 text-sm mb-2">⭐ {{ g.rating ?? '—' }}</p>
                        <button
                            type="button"
                            class="btn-primary mt-auto"
                            data-action="live#action"
                            data-live-action-param="selectGame"
                            data-live-id-param="{{ g.id }}">
                            Sélectionner
                        </button>
                    </div>
                </div>
            {% endfor %}
        </div>

        <div class="mt-6 flex justify-center items-center gap-2">
            {% for p in 1..maxPageLoaded %}
                <button
                    type="button"
                    class="px-3 py-1 rounded-lg border {{ p == page ? 'bg-neonBlue text-black' : 'bg-gray-800 text-gray-300 hover:bg-gray-700 cursor-pointer' }}"
                    data-action="live#action"
                    data-live-action-param="goToPage"
                    data-live-page-param="{{ p }}">
                    {{ p }}
                </button>
            {% endfor %}

            <button
                type="button"
                class="px-3 py-1 rounded-lg bg-gray-800 text-gray-300 hover:bg-gray-700 cursor-pointer"
                data-action="live#action"
                data-live-action-param="nextPage">
                Suivant →
            </button>
        </div>

    {% elseif query %}
        <p class="text-gray-400 italic mt-4">Aucun résultat trouvé pour "{{ query }}".</p>
    {% endif %}
</div>
