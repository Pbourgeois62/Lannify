<div {{ attributes }}>
	<div class="overflow-x-auto rounded-2xl border border-neonBlue/50 shadow-xl bg-darkGrey/60 backdrop-blur-md">
		<table class="w-full text-left text-white">
			<thead class="bg-darkGrey/80 border-b border-neonBlue/50">
				<tr>
					<th class="px-6 py-3 text-neonBlue font-semibold uppercase text-sm tracking-wide">Nom</th>
					<th class="px-6 py-3 text-neonBlue font-semibold uppercase text-sm tracking-wide">Source</th>
					<th class="px-6 py-3 text-neonBlue font-semibold uppercase text-sm tracking-wide">Gratuit ?</th>
					<th class="px-6 py-3 text-neonBlue font-semibold uppercase text-sm tracking-wide">Je poss√®de</th>
					<th class="px-6 py-3 text-neonBlue font-semibold uppercase text-sm tracking-wide">Je veux jouer</th>
				</tr>
			</thead>

			<tbody>
				{% for pg in participantGames %}
					{% set game = pg.game %}
					<tr class="border-b border-neonBlue/30 hover:bg-neonBlue/10 transition-all duration-300">

						<!-- Nom + tooltip joueurs pr√™ts -->
						<td id="game-{{ game.id }}" class="px-6 py-4 font-medium text-neonBlue flex items-center gap-3">
							{% set ready = readyCounts[game.id] ?? 0 %}

							{% if ready > 0 %}
								<button
									type="button"
									class="flex items-center text-xs bg-vibrantGreen/90 hover:bg-vibrantGreen text-spaceBlack px-3 py-1.5 rounded-full font-semibold shadow-sm transition"
									data-tooltip-target="tooltip-{{ game.id }}"
									data-tooltip-placement="right"
								>
									<span class="font-bold mr-1">{{ ready }}</span> üëç
								</button>

								<div id="tooltip-{{ game.id }}"
									role="tooltip"
									class="absolute z-20 invisible opacity-0 inline-block max-w-xs px-4 py-3 text-sm text-white bg-darkGrey/95 rounded-xl shadow-xl border border-neonBlue/40 tooltip transition-opacity duration-200">
									
									<div class="flex flex-col gap-2">
										<span class="text-neonBlue font-semibold border-b border-neonBlue/40 pb-1">Pr√™ts √† jouer :</span>
										{% for pg in readyUsers[game.id]|default([]) %}
											<div class="flex items-center gap-2 hover:bg-neonBlue/10 rounded-lg p-1 transition">
												<img src="{{ app.user.profile.getAvatarPath() }}"
													 alt="{{ pg.participant.profile.nickname }}"
													 class="rounded-full w-8 h-8 object-cover border border-neonBlue/60">
												<span>{{ pg.participant.profile.nickname }}</span>
											</div>
										{% else %}
											<span class="text-gray-400">Aucun participant pr√™t</span>
										{% endfor %}
									</div>

									<div class="tooltip-arrow" data-popper-arrow></div>
								</div>
							{% endif %}

							<span class="text-base font-semibold">{{ game.label }}</span>
						</td>

						<!-- Source -->
						<td class="px-6 py-4 text-gray-300 italic">{{ game.source ?: '‚Äî' }}</td>

						<!-- Gratuit -->
						<td class="px-6 py-4">
							<span class="px-3 py-1 rounded-full text-sm font-semibold
								{% if game.free %} bg-neonBlue/90 text-darkGrey
								{% elseif game.free is same as(false) %} bg-red-600/80 text-white
								{% else %} bg-gray-600/70 text-white {% endif %}">
								{{ game.free ? 'Oui' : (game.free is same as(false) ? 'Non' : '‚Äî') }}
							</span>
						</td>

						<!-- Je poss√®de -->
						<td class="px-6 py-4">
							<label class="inline-flex items-center cursor-pointer">
								<input type="checkbox"
									   class="sr-only peer"
									   {{ pg.owns ? 'checked' : '' }}
									   data-action="live#action"
									   data-live-action-param="toggleOwned"
									   data-live-id-param="{{ game.id }}">
								<div class="relative w-11 h-6 rounded-full bg-gray-700 peer-checked:bg-green-500
									after:content-[''] after:absolute after:top-[2px] after:left-[2px]
									after:bg-white after:border after:border-gray-300 after:rounded-full
									after:h-5 after:w-5 after:transition-all
									peer-checked:after:translate-x-full"></div>
							</label>
						</td>

						<!-- Je veux jouer -->
						<td class="px-6 py-4">
							<label class="inline-flex items-center cursor-pointer">
								<input type="checkbox"
									   class="sr-only peer"
									   {{ pg.interested ? 'checked' : '' }}
									   data-action="live#action"
									   data-live-action-param="toggleInterested"
									   data-live-id-param="{{ game.id }}">
								<div class="relative w-11 h-6 rounded-full bg-gray-700 peer-checked:bg-neonBlue
									after:content-[''] after:absolute after:top-[2px] after:left-[2px]
									after:bg-white after:border after:border-gray-300 after:rounded-full
									after:h-5 after:w-5 after:transition-all
									peer-checked:after:translate-x-full"></div>
							</label>
						</td>
					</tr>
				{% else %}
					<tr>
						<td colspan="5" class="text-center py-6 text-gray-400 italic">Aucun jeu trouv√© pour cet √©v√®nement.</td>
					</tr>
				{% endfor %}
			</tbody>
		</table>
	</div>
</div>
